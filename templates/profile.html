{% extends 'base.html' %}
{% block title %}User Profile{% endblock %}
{% block content %}
<h1>User Profile</h1>
<hr>
<h2>Recommended Recipes for You:</h2>
<div class="row">
    <div class="col-4"></div>
    <div class="col-4">
        <div class="container carousel-container d-none d-sm-block w-100">
  <form action='/check-meal' method='POST'>
  <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
    {% for tuple in highest %}
        {% if loop.first %}
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        {% else %}
        <li data-target="#carouselExampleIndicators" data-slide-to="{{ loop.index0 }}"></li>
        {% endif %}
    {% endfor %}  
    </ol>
    <div class="carousel-inner">
        {% for score, recipe in highest %}
            {% if loop.first %}
            <div class="carousel-item active">
                <a href="{{ recipe.url }}">
                    <img class="recommended d-block w-100" src="{{ recipe.image_url }}">
                </a>
                <div class="carousel-caption d-none d-md-block">
                    <h2 style="color: white; font-weight: bolder;">{{ recipe.recipe_name }}</h2><br>
                    {% for i in range(score) %}
                    <span class="fa fa-star checked"></span>
                    {% endfor %}
                    <input type="checkbox" name="recipes" value="{{ recipe.recipe_id }}">
                </div>
            </div>
            {% else %}
            <div class="carousel-item">
                <a href="{{ recipe.url }}">
                    <img class="recommended d-block w-100" src="{{ recipe.image_url }}">
                </a>
                <div class="carousel-caption d-none d-md-block">
                    <h2 style="color: white; font-weight: bolder;">{{ recipe.recipe_name }}</h2><br>
                    {% for i in range(score) %}
                    <span class="fa fa-star checked"></span>
                    {% endfor %}
                    <input type="checkbox" name="recipes" value="{{ recipe.recipe_id }}">
                </div>
            </div>
            {% endif %}
        {% endfor %}
    </div>
    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
  <input type="submit" value="Add to meal plan!">
  </form>
    </div>
    </div>
    <div class="col-4"></div>
</div>
<hr>
{% if recipes %}
<h2>Current Meal Plan</h2>
    <div id="recipes-list" class="row">
      {% for recipe in recipes %}
      <div class="col-4 recipes d-flex align-items-stretch" data-id="{{ recipe.recipe.recipe_id }}">
        <div class="card bg-light m-3 w-100">
            <form action='/delete-recipe' method='POST'>
                <div class="card-header">
                    <div class="row d-flex">
                        <div class="col-1"></div>
                        <div class="col-10 d-flex">
                            <h5>{{ recipe.recipe.recipe_name }}</h5>
                        </div>
                        <div class="col-1 d-flex align-items-center w-100">
                        <button type="button" class="btn btn-outline-primary w-100" d-flex justify-content-center align-items-center" name="recipe_id" value="{{ recipe.recipe.recipe_id }}">&times;</button>
                        </div>
                        <div class="col-1"></div>
                    </div>
                </div>
                <div class="card-body d-flex flex-column align-items-center">  
                        <a href="{{ recipe.recipe.url }}">
                            <img class="userrecipe w-100" id="{{ recipe.recipe.recipe_id }}" src="{{ recipe.recipe.image_url }}" data-toggle="tooltip" title="Click for recipe."><br>
                        </a>
                    <div class="stars">
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-5" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="5" /><label for="{{ recipe.recipe.recipe_id }}-5"></label>
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-4" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="4" /><label for="{{ recipe.recipe.recipe_id }}-4"></label>
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-3" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="3" /><label for="{{ recipe.recipe.recipe_id }}-3"></label>
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-2" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="2" /><label for="{{ recipe.recipe.recipe_id }}-2"></label>
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-1" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="1" /><label for="{{ recipe.recipe.recipe_id }}-1"></label>
                      <input type="radio" id="{{ recipe.recipe.recipe_id }}-0" data-id="{{ recipe.recipe.recipe_id }}" name="rating" value="0" class="star-cb-clear" />
                    </div>
                </div>
            </form>
        </div>
      </div>
      {% endfor %}
    </div>
{% else %}
<h3>No recipes to display.</h3>
{% endif %}
<hr>
<form action="/clear-meals" method="POST">
    <input type="submit" value="Start Fresh">
</form>

<div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h4 class="modal-title w-100 font-weight-bold">What ingredients would you like to cook with this week?</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body mx-3">
                    <form class="profile-form" action="/plan-meal" method='POST'>
                        <input type="text" name="ingredients" multiple required="">
                        <select name="types" multiple required>
                            <option value="Dairy">Dairy</option>
                            <option value="Proteins">Proteins</option>
                            <option value="Soups, Sauces, and Gravies">Soups, Sauces, and Gravies</option>
                            <option value="Produce">Produce</option>
                            <option value="Nuts and Seeds">Nuts and Seeds</option>
                            <option value="Grains and Pasta">Grains and Pasta</option>
                        </select>
                        <button type="button" class="new-button">+</button><br>
            </div> <!-- Modal div ender -->
            <div class="modal-footer d-flex justify-content-center">
                <input type="submit" class='submit-button'>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="text-center">
    <a href="" class="btn btn-default btn-rounded mb-4" data-toggle="modal" data-target="#modalLoginForm">Create a Meal Plan!</a>
</div>

{% endblock %}